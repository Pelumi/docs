<svg width="800" height="600" viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="800" height="600" fill="#f8fafc"/>
  
  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" font-family="Inter, sans-serif" font-size="20" font-weight="600" fill="#1e293b">
    Terminal Integration Flow
  </text>
  
  <!-- Client Box -->
  <rect x="50" y="80" width="150" height="80" rx="8" fill="#3b82f6" stroke="#2563eb" stroke-width="2"/>
  <text x="125" y="110" text-anchor="middle" font-family="Inter, sans-serif" font-size="14" font-weight="600" fill="white">
    Client Application
  </text>
  <text x="125" y="130" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" fill="white">
    (Your Backend)
  </text>
  
  <!-- Terminal Box -->
  <rect x="600" y="80" width="150" height="80" rx="8" fill="#10b981" stroke="#059669" stroke-width="2"/>
  <text x="675" y="110" text-anchor="middle" font-family="Inter, sans-serif" font-size="14" font-weight="600" fill="white">
    Nomba Terminal
  </text>
  <text x="675" y="130" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" fill="white">
    (Physical Device)
  </text>
  
  <!-- Step 1: Upload Virtual Terminal -->
  <g id="step1">
    <!-- Arrow -->
    <path d="M210 120 L590 120" stroke="#ef4444" stroke-width="3" fill="none" marker-end="url(#arrowhead-red)"/>
    <!-- Label -->
    <rect x="320" y="95" width="160" height="30" rx="4" fill="#fee2e2" stroke="#ef4444"/>
    <text x="400" y="108" text-anchor="middle" font-family="Inter, sans-serif" font-size="11" font-weight="500" fill="#dc2626">
      1. Upload Virtual Terminal
    </text>
    <text x="400" y="120" text-anchor="middle" font-family="Inter, sans-serif" font-size="10" fill="#dc2626">
      POST /v1/terminals/upload-virtual-terminal
    </text>
  </g>
  
  <!-- Step 2: Initialize Terminal -->
  <g id="step2">
    <!-- Arrow -->
    <path d="M210 180 L590 180" stroke="#f59e0b" stroke-width="3" fill="none" marker-end="url(#arrowhead-orange)"/>
    <!-- Label -->
    <rect x="320" y="155" width="160" height="30" rx="4" fill="#fef3c7" stroke="#f59e0b"/>
    <text x="400" y="168" text-anchor="middle" font-family="Inter, sans-serif" font-size="11" font-weight="500" fill="#d97706">
      2. Initialize Terminal
    </text>
    <text x="400" y="180" text-anchor="middle" font-family="Inter, sans-serif" font-size="10" fill="#d97706">
      POST /v1/terminals/{serialNumber}/initialize
    </text>
  </g>
  
  <!-- Response Arrow for Step 2 -->
  <g id="step2-response">
    <path d="M590 200 L210 200" stroke="#f59e0b" stroke-width="2" fill="none" marker-end="url(#arrowhead-orange-small)" stroke-dasharray="5,5"/>
    <text x="400" y="215" text-anchor="middle" font-family="Inter, sans-serif" font-size="10" fill="#d97706">
      Terminal ID & Configuration
    </text>
  </g>
  
  <!-- Step 3: Key Exchange -->
  <g id="step3">
    <!-- Arrow -->
    <path d="M210 260 L590 260" stroke="#8b5cf6" stroke-width="3" fill="none" marker-end="url(#arrowhead-purple)"/>
    <!-- Label -->
    <rect x="320" y="235" width="160" height="30" rx="4" fill="#ede9fe" stroke="#8b5cf6"/>
    <text x="400" y="248" text-anchor="middle" font-family="Inter, sans-serif" font-size="11" font-weight="500" fill="#7c3aed">
      3. Key Exchange
    </text>
    <text x="400" y="260" text-anchor="middle" font-family="Inter, sans-serif" font-size="10" fill="#7c3aed">
      POST /v1/terminals/{terminalId}/key-exchange
    </text>
  </g>
  
  <!-- Step 4: Transaction Processing -->
  <g id="step4">
    <!-- Branching line -->
    <path d="M400 320 L400 350" stroke="#374151" stroke-width="2"/>
    <path d="M300 350 L500 350" stroke="#374151" stroke-width="2"/>
    
    <!-- Card Transaction Branch -->
    <g id="card-branch">
      <path d="M300 350 L300 380 L590 380" stroke="#06b6d4" stroke-width="3" fill="none" marker-end="url(#arrowhead-cyan)"/>
      <rect x="210" y="365" width="180" height="30" rx="4" fill="#cffafe" stroke="#06b6d4"/>
      <text x="300" y="378" text-anchor="middle" font-family="Inter, sans-serif" font-size="11" font-weight="500" fill="#0891b2">
        4a. Card Transaction
      </text>
      <text x="300" y="390" text-anchor="middle" font-family="Inter, sans-serif" font-size="10" fill="#0891b2">
        POST /v1/terminals/card-transaction
      </text>
    </g>
    
    <!-- OR Text -->
    <circle cx="400" cy="350" r="15" fill="#6b7280"/>
    <text x="400" y="355" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" font-weight="600" fill="white">
      OR
    </text>
    
    <!-- PBT Branch -->
    <g id="pbt-branch">
      <path d="M500 350 L500 440 L590 440" stroke="#ec4899" stroke-width="3" fill="none" marker-end="url(#arrowhead-pink)"/>
      <rect x="420" y="425" width="160" height="30" rx="4" fill="#fce7f3" stroke="#ec4899"/>
      <text x="500" y="438" text-anchor="middle" font-family="Inter, sans-serif" font-size="11" font-weight="500" fill="#db2777">
        4b. Initialize PBT
      </text>
      <text x="500" y="450" text-anchor="middle" font-family="Inter, sans-serif" font-size="10" fill="#db2777">
        POST /v1/terminals/pbt/initialize
      </text>
    </g>
  </g>
  
  <!-- Step Labels -->
  <text x="50" y="320" font-family="Inter, sans-serif" font-size="14" font-weight="600" fill="#374151">
    Choose Transaction Type:
  </text>
  
  <!-- Success Indicators -->
  <g id="success">
    <circle cx="675" cy="500" r="20" fill="#10b981"/>
    <path d="M667 500 L673 506 L683 494" stroke="white" stroke-width="3" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
    <text x="675" y="530" text-anchor="middle" font-family="Inter, sans-serif" font-size="12" font-weight="500" fill="#059669">
      Ready for Payment
    </text>
  </g>
  
  <!-- Arrow markers -->
  <defs>
    <marker id="arrowhead-red" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#ef4444"/>
    </marker>
    <marker id="arrowhead-orange" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#f59e0b"/>
    </marker>
    <marker id="arrowhead-orange-small" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#f59e0b"/>
    </marker>
    <marker id="arrowhead-purple" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#8b5cf6"/>
    </marker>
    <marker id="arrowhead-cyan" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#06b6d4"/>
    </marker>
    <marker id="arrowhead-pink" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#ec4899"/>
    </marker>
  </defs>
</svg>
